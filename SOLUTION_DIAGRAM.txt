â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                  ORANGEHRM DOCKER PERSISTENCE SOLUTION                        â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

THE PROBLEM:
â•â•â•â•â•â•â•â•â•â•â•â•â•

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Developer  â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”œâ”€â†’ "docker compose down"
           â”‚
           â”œâ”€â†’ "docker compose up -d --build"
           â”‚
           â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  âŒ Setup wizard appears AGAIN    â”‚
    â”‚  âŒ Database data is GONE         â”‚
    â”‚  âŒ Configuration is LOST         â”‚
    â”‚  âŒ Must reconfigure everything   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

WHY IT HAPPENED:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    Docker Volume Conflict:
    
    volumes:
      - orangehrm_data:/var/www/html          â† Mounts ENTIRE app directory
      - ./src/config:/var/www/html/src/config â† This gets OVERWRITTEN!
      
    Result: Configuration lost on every rebuild


THE SOLUTION:
â•â•â•â•â•â•â•â•â•â•â•â•â•

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Developer  â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”œâ”€â†’ "docker compose down"
           â”‚
           â”œâ”€â†’ "docker compose up -d --build"
           â”‚
           â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  âœ… No wizard (goes to login)     â”‚
    â”‚  âœ… Database data PERSISTS        â”‚
    â”‚  âœ… Configuration SAVED           â”‚
    â”‚  âœ… Everything works!             â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

HOW IT WORKS NOW:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    Specific Volume Mounts:
    
    volumes:
      - orangehrm_config:/var/www/html/src/config   â† Config persists!
      - orangehrm_cache:/var/www/html/src/cache     â† Cache persists!
      - orangehrm_log:/var/www/html/src/log         â† Logs persist!
      - orangehrm_data:/var/www/html/src/.../data   â† User data persists!
      
    Result: Only data directories mounted, configuration survives rebuilds


ARCHITECTURE DIAGRAM:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                      DOCKER HOST                              â”‚
    â”‚                                                               â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
    â”‚  â”‚  MySQL         â”‚         â”‚  OrangeHRM     â”‚               â”‚
    â”‚  â”‚  Container     â”‚         â”‚  Container     â”‚               â”‚
    â”‚  â”‚                â”‚         â”‚                â”‚               â”‚
    â”‚  â”‚  Port: 3306   â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”¤  Port: 80      â”‚               â”‚
    â”‚  â”‚                â”‚         â”‚                â”‚               â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
    â”‚          â”‚                       â”‚                           â”‚
    â”‚          â”‚                       â”‚                           â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
    â”‚  â”‚  PERSISTED VOLUMES     â”‚                          â”‚      â”‚
    â”‚  â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•    â”‚                          â”‚      â”‚
    â”‚  â”‚                        â”‚                          â”‚      â”‚
    â”‚  â”‚  mysql_data           â”‚  orangehrm_config         â”‚      â”‚
    â”‚  â”‚  â”‚                     â”‚  â”‚                        â”‚      â”‚
    â”‚  â”‚  â”œâ”€ Database tables   â”‚  â”œâ”€ Conf.php â† Important! â”‚      â”‚
    â”‚  â”‚  â”œâ”€ User data         â”‚  â”‚                        â”‚      â”‚
    â”‚  â”‚  â””â”€ All DB files      â”‚  orangehrm_cache         â”‚      â”‚
    â”‚  â”‚                        â”‚  â”‚                        â”‚      â”‚
    â”‚  â”‚                        â”‚  â”œâ”€ Compiled templates   â”‚      â”‚
    â”‚  â”‚                        â”‚  â”‚                        â”‚      â”‚
    â”‚  â”‚                        â”‚  orangehrm_log           â”‚      â”‚
    â”‚  â”‚                        â”‚  â”‚                        â”‚      â”‚
    â”‚  â”‚                        â”‚  â”œâ”€ Application logs     â”‚      â”‚
    â”‚  â”‚                        â”‚  â”‚                        â”‚      â”‚
    â”‚  â”‚                        â”‚  orangehrm_data          â”‚      â”‚
    â”‚  â”‚                        â”‚  â”‚                        â”‚      â”‚
    â”‚  â”‚                        â”‚  â””â”€ User uploads         â”‚      â”‚
    â”‚  â”‚                        â”‚                          â”‚      â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
    â”‚                                                               â”‚
    â”‚  These volumes PERSIST across container rebuilds!            â”‚
    â”‚                                                               â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


DATA FLOW:
â•â•â•â•â•â•â•â•â•â•

    FIRST TIME SETUP:
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    
    1. docker compose up -d --build
    2. Visit http://localhost:8080
    3. Setup wizard appears
    4. Complete wizard with database details
    5. Wizard creates: /var/www/html/src/config/Conf.php
    6. Conf.php is written to orangehrm_config volume
    7. Setup complete!
    
    
    SUBSEQUENT REBUILDS:
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    
    1. docker compose down
    2. docker compose up -d --build
    3. New container starts
    4. Mounts orangehrm_config volume
    5. Finds existing Conf.php
    6. Skips wizard, goes to login
    7. Database data still intact in mysql_data volume
    8. Everything works!


FILE STRUCTURE:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    Project Root/
    â”‚
    â”œâ”€â”€ docker-compose.yml           â† âœ… UPDATED (main)
    â”œâ”€â”€ docker-compose.prod.yml      â† âœ… UPDATED (production)
    â”œâ”€â”€ docker-compose.simple.yml    â† âœ… UPDATED (simple)
    â”‚
    â”œâ”€â”€ START_HERE.md                â† ğŸ“„ NEW (start here!)
    â”œâ”€â”€ QUICK_FIX_SUMMARY.md         â† ğŸ“„ NEW (overview)
    â”œâ”€â”€ DOCKER_PERSISTENCE_GUIDE.md  â† ğŸ“„ NEW (detailed guide)
    â”œâ”€â”€ MIGRATION_CHECKLIST.md       â† ğŸ“„ NEW (step-by-step)
    â”œâ”€â”€ BEFORE_AFTER_COMPARISON.md   â† ğŸ“„ NEW (comparison)
    â”œâ”€â”€ SOLUTION_DIAGRAM.txt         â† ğŸ“„ NEW (this file)
    â”‚
    â””â”€â”€ docker-helper.ps1            â† ğŸ”§ NEW (helper script)


MIGRATION STEPS:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘  OPTION 1: FRESH START (Recommended)  â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    1. docker compose down -v
    2. docker compose up -d --build
    3. Complete wizard (one time!)
    4. Done!
    
    
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘  OPTION 2: KEEP EXISTING DATA         â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    1. Backup: .\docker-helper.ps1 backup
    2. docker compose down
    3. docker compose up -d --build
    4. If wizard appears, complete and restore backup
    5. Done!
    
    
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘  OPTION 3: USE HELPER SCRIPT          â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    1. .\docker-helper.ps1 backup
    2. .\docker-helper.ps1 reset (type 'yes')
    3. .\docker-helper.ps1 start
    4. Complete wizard
    5. Done!


VERIFICATION:
â•â•â•â•â•â•â•â•â•â•â•â•â•

    Test the fix works:
    
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ $ docker compose down                â”‚
    â”‚ $ docker compose up -d --build      â”‚
    â”‚ $ # Visit http://localhost:8080     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    
    Expected Result:
    âœ… No setup wizard
    âœ… Login page appears
    âœ… Can log in successfully
    âœ… All data intact
    
    If you see this: SUCCESS! ğŸ‰


HELPER COMMANDS:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    PowerShell Helper Script:
    
    .\docker-helper.ps1               # Show all commands
    .\docker-helper.ps1 start         # Start containers
    .\docker-helper.ps1 stop          # Stop (keep data)
    .\docker-helper.ps1 rebuild       # Rebuild (keep data)
    .\docker-helper.ps1 backup        # Backup database
    .\docker-helper.ps1 status        # Show status
    
    
    Manual Commands:
    
    docker compose up -d              # Start
    docker compose down               # Stop (keep data)
    docker compose up -d --build      # Rebuild (keep data)
    docker compose down -v            # Delete everything
    docker compose ps                 # Show status
    docker logs orangehrm_app -f      # View logs


VOLUME DETAILS:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Volume Name         â”‚ Purpose                               â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚ mysql_data          â”‚ MySQL database files                  â”‚
    â”‚ orangehrm_config    â”‚ Installation config (Conf.php)        â”‚
    â”‚ orangehrm_cache     â”‚ Application cache                     â”‚
    â”‚ orangehrm_log       â”‚ Application logs                      â”‚
    â”‚ orangehrm_data      â”‚ User uploads, files                   â”‚
    â”‚ redis_data          â”‚ Session storage (optional)            â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    
    View volumes:
    docker volume ls | findstr orangehrm
    
    Inspect volume:
    docker volume inspect orangehrm_mysql_data


SUCCESS CRITERIA:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    You know it's working when:
    
    âœ… Setup wizard appears only ONCE
    âœ… Can rebuild without losing data
    âœ… Can stop/start containers freely
    âœ… Database persists
    âœ… Configuration persists
    âœ… No more frustration!


SUPPORT:
â•â•â•â•â•â•â•â•

    Read the documentation:
    
    1. START_HERE.md                 â† Quick start (3 steps)
    2. QUICK_FIX_SUMMARY.md          â† Quick overview
    3. MIGRATION_CHECKLIST.md        â† Step-by-step guide
    4. DOCKER_PERSISTENCE_GUIDE.md   â† Detailed reference
    5. BEFORE_AFTER_COMPARISON.md    â† Visual comparison
    
    Use the helper:
    
    .\docker-helper.ps1              â† PowerShell automation


â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                           SOLUTION COMPLETE! âœ…                               â•‘
â•‘                                                                               â•‘
â•‘  Next Step: Read START_HERE.md and run the 3 commands to get started!       â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

